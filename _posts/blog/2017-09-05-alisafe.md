---
layout: post
title: 阿里云安全大赛
categories: 比赛
description: 阿里云安全大赛
keywords: 安全，机器学习
---

# 第二届阿里云安全算法挑战赛
## 《扫描爆破拦截》

赛题详情见：[https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.7c560628QDU4eu&raceId=231612](https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.7c560628QDU4eu&raceId=231612)

### 特征提取

主要从三分方向：

1. 用户端口维度

2. 用户维度 

3. 端口维度

### 分端口训练

考虑到每个端口的正负样本比例不同，所以将四个端口分开训练。


### 对于正负样本比例不均衡问题的解决

之前就发现训练集有这个问题。下边展示了各端口的正负样本比例。

| 端口 | 正样本数 | 负样本数 | 正负比例|
| :----:| :----:| :----:| :----:|
| 21  | 1267|168110|1:132|
|  22 |4642 |96995|1:20|
|3306|279|108128|1:387|
|3389|2663|89069|1:33|

网上找很多都是采用欠采样和过采样来处理的，感觉还是比较疑惑，怕这样采样不好，会破坏数据，所以今天找了之前在公司的导师，以下是宇哥的原话：
>有一种模型上比较猥琐的方法，你可以试试。把好样本分N份，+ 坏样本，正负比例搞的10：1这种。然后训练n个小模型，再做一层级联。

为了验证他的方法，我对21号端口进行了类型处理，将负例分成了十份，这里只是根据标号简单的分为了10份，这种方法还是有待考究的（和队友还商量可以有放回的采样10份，这个之后再验证吧）。

查看每个小模型的结果如下

![](/images/posts/competition/littemode.jpg)

可以看出模型的效果并不好，正例的精确率只有56%。

### 黑白名单问题


### 网上找到的资料

#### 处理样本不平衡问题

需要对负样本进行随机抽样，利用多模型进行训练

#### 通用多模型Ensemble过程
1. Train数据训练出Model_0，Model_1，Model_2...Model_i.得到(probability_0,probability_2...probability_i,label)
2. 再用一个EnsembleModel再训练一次，得到到EnsembleModel

### 模型选择 

LR 随机森林  GBDT


## 尝试 --按小时统计

由于预测集合只给了hh=('00','02','04','06','08','10','12','14','16','18','20','22')时间的连接数据，而训练集提供的是24个小时的。

总统计样本比例 正：负=84820：1209519=1：14

### 21端口
21端口正负样本情况：

|类型|正样本数|负样本数|正负比|
|:---:|:---:|:---:|:---:|
|总|11406|447209|1：39|
|老用户|9377|288140|1:30|
|新用户|2029|159069|1:78|

